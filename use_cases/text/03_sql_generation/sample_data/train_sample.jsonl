{"messages": [{"role": "user", "content": "How many orders were placed in January 2025?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS order_count FROM orders WHERE created_at >= '2025-01-01' AND created_at < '2025-02-01';"}]}
{"messages": [{"role": "user", "content": "What is the average order value per customer?"}, {"role": "assistant", "content": "SELECT u.id, u.name, AVG(o.total) AS avg_order_value FROM users u JOIN orders o ON o.user_id = u.id GROUP BY u.id, u.name;"}]}
{"messages": [{"role": "user", "content": "Show the top 10 products by total revenue."}, {"role": "assistant", "content": "SELECT p.id, p.name, SUM(oi.quantity * oi.unit_price) AS total_revenue FROM products p JOIN order_items oi ON oi.product_id = p.id GROUP BY p.id, p.name ORDER BY total_revenue DESC LIMIT 10;"}]}
{"messages": [{"role": "user", "content": "List all customers who have never placed an order."}, {"role": "assistant", "content": "SELECT u.id, u.name, u.email FROM users u LEFT JOIN orders o ON o.user_id = u.id WHERE o.id IS NULL;"}]}
{"messages": [{"role": "user", "content": "What is the total revenue for each product category?"}, {"role": "assistant", "content": "SELECT p.category, SUM(oi.quantity * oi.unit_price) AS total_revenue FROM products p JOIN order_items oi ON oi.product_id = p.id GROUP BY p.category ORDER BY total_revenue DESC;"}]}
{"messages": [{"role": "user", "content": "Find all orders with a total greater than $500."}, {"role": "assistant", "content": "SELECT id, user_id, status, total, created_at FROM orders WHERE total > 500 ORDER BY total DESC;"}]}
{"messages": [{"role": "user", "content": "Which customer has spent the most money overall?"}, {"role": "assistant", "content": "SELECT u.id, u.name, u.email, SUM(o.total) AS total_spent FROM users u JOIN orders o ON o.user_id = u.id GROUP BY u.id, u.name, u.email ORDER BY total_spent DESC LIMIT 1;"}]}
{"messages": [{"role": "user", "content": "How many users signed up in the last 30 days?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS new_users FROM users WHERE created_at >= NOW() - INTERVAL '30 days';"}]}
{"messages": [{"role": "user", "content": "What are the top 5 most frequently ordered products?"}, {"role": "assistant", "content": "SELECT p.id, p.name, SUM(oi.quantity) AS total_quantity FROM products p JOIN order_items oi ON oi.product_id = p.id GROUP BY p.id, p.name ORDER BY total_quantity DESC LIMIT 5;"}]}
{"messages": [{"role": "user", "content": "Show all cancelled orders along with the customer name and email."}, {"role": "assistant", "content": "SELECT o.id AS order_id, o.total, o.created_at, u.name, u.email FROM orders o JOIN users u ON u.id = o.user_id WHERE o.status = 'cancelled' ORDER BY o.created_at DESC;"}]}
{"messages": [{"role": "user", "content": "What is the average number of items per order?"}, {"role": "assistant", "content": "SELECT AVG(item_count) AS avg_items_per_order FROM (SELECT order_id, SUM(quantity) AS item_count FROM order_items GROUP BY order_id) sub;"}]}
{"messages": [{"role": "user", "content": "Find products that have never been ordered."}, {"role": "assistant", "content": "SELECT p.id, p.name, p.category, p.price FROM products p LEFT JOIN order_items oi ON oi.product_id = p.id WHERE oi.id IS NULL;"}]}
{"messages": [{"role": "user", "content": "Which country has the most registered users?"}, {"role": "assistant", "content": "SELECT country, COUNT(*) AS user_count FROM users GROUP BY country ORDER BY user_count DESC LIMIT 1;"}]}
{"messages": [{"role": "user", "content": "What percentage of orders have been delivered?"}, {"role": "assistant", "content": "SELECT ROUND(100.0 * COUNT(*) FILTER (WHERE status = 'delivered') / COUNT(*), 2) AS delivered_pct FROM orders;"}]}
{"messages": [{"role": "user", "content": "Show all products that are currently out of stock."}, {"role": "assistant", "content": "SELECT id, name, category, price FROM products WHERE stock = 0 ORDER BY name;"}]}
